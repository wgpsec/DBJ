<h1 align="center">DBJå¤§å®å‰‘ ğŸ—¡</h1>

![](https://img.shields.io/badge/ReaTeam-%E6%AD%A6%E5%99%A8%E5%BA%93-red)![](https://img.shields.io/badge/license-GPL--3.0-orange)![](https://img.shields.io/badge/version-1.0.1-brightgreen)![](https://img.shields.io/badge/author-wintrysec%20%E6%B8%A9%E9%85%92-blueviolet)![](https://img.shields.io/badge/WgpSec-%E7%8B%BC%E7%BB%84%E5%AE%89%E5%85%A8%E5%9B%A2%E9%98%9F-blue)

![](https://gitee.com/wintrysec/images/raw/master/banner.jpg)

## æ¦‚è¿°

### å®šä½ï¼šè¾¹ç•Œèµ„äº§æ¢³ç†å·¥å…·

**é¡¹ç›®å¤„äºæµ‹è¯•é˜¶æ®µï¼Œä»£ç ä¼šæ—¶å¸¸æ›´æ–°ï¼Œå„ä½å¸ˆå‚…ç‚¹ä¸ª`Star`å…³æ³¨ä¸‹**

```bash
æŠ€æœ¯æ ˆå¦‚ä¸‹

å‰ç«¯   Layui
æœåŠ¡ç«¯ Python-Flask
ç¼“å­˜   Redis
æŒä¹…åŒ– MongoDB
```

## åŠŸèƒ½ç®€ä»‹

bilibiliè§†é¢‘åœ°å€

### ä¼ä¸šç»„ç»‡æ¶æ„æŸ¥è¯¢

![](/data/readme/enscan1.png)

1ã€çˆ¬è™«ä»çˆ±ä¼æŸ¥æŸ¥è¯¢ä¼ä¸šçš„ç»„ç»‡æ¶æ„ï¼Œä¸€çº§å•ä½ã€äºŒçº§å•ä½çš„é¦–é¡µå’Œé‚®ç®±ç­‰ä¿¡æ¯

2ã€æ ¹æ®ä¼ä¸šçš„å…¬å¸åç§°whoisåæŸ¥åŸŸåã€ICPå¤‡æ¡ˆåæŸ¥åŸŸåï¼Œæ‰€æœ‰ä¸€çº§å•ä½äºŒçº§å•ä½éƒ½ä¼šè¿›è¡ŒICPåæŸ¥


### å­åŸŸåèµ„äº§æ¢³ç†

**è¿™å—ä¸‹ä»»åŠ¡çš„æ ¼å¼æ³¨æ„ä¸‹**

```bash
#å¡«å†™ä¸€çº§åŸŸå
baidu.com
```

**å­åŸŸåæŸ¥è¯¢æ¨¡å—**ï¼š
æœ€ç»ˆè¿”å›çš„ä¿¡æ¯æ˜¯ï¼š`ä¸»æœºåœ°å€ã€è§£æIPã€ç½‘ç«™æ ‡é¢˜ã€Serverã€åº”ç”¨æŒ‡çº¹ã€ç›®å½•æ‰«æã€åœ°ç†ä½ç½®ã€è¿è¥å•†`

```bash
ä¸»æœºåœ°å€ï¼šæ‰€æœ‰å­åŸŸåå’Œé€šè¿‡httpsè¯ä¹¦è·å–IPèµ„äº§
è§£æIPï¼šæœ€ç»ˆè§£æå‡ºçš„IPæˆ–è€…CDNçš„æ ‡è¯†
ç½‘ç«™æ ‡é¢˜ï¼šç½‘ç«™çš„title
Serverï¼šä½¿ç”¨çš„æœåŠ¡å™¨ä¸­é—´ä»¶ï¼Œä¾‹å¦‚IISã€Apacheç­‰Webå®¹å™¨
åº”ç”¨æŒ‡çº¹ï¼šç½‘ç«™ä½¿ç”¨çš„åº”ç”¨æˆ–è®¾å¤‡ç±»å‹ï¼Œä¾‹å¦‚Shiroæ¡†æ¶ã€Weblogicä¸­é—´ä»¶ã€TPå¼€å‘æ¡†æ¶ã€å„ç§OAç³»ç»Ÿ
ç›®å½•æ‰«æï¼šç®€å•çš„æ‰«æå¸¸è§çš„åå°å’Œæºç æ³„éœ²ï¼ˆéƒ¨åˆ†WAFä¼šç›´æ¥æ‹¦æˆªï¼‰
åœ°ç†ä½ç½®ï¼šé€šè¿‡æ·˜å®åº“æŸ¥è¯¢IPçš„åœ°ç†ä½ç½®å’Œè¿è¥å•†ï¼ˆFOFAè¿”å›çš„åœ°ç†ä½ç½®ä¸å‡†ç¡®ï¼‰
```

**å­åŸŸåè·å–æµç¨‹**ï¼š

1ã€FOFAå–æ•°æ®
è¯­æ³•ï¼š`domain="baidu.com"` ï¼Œä¸è¿‡æ»¤è¯·æ±‚è¿”å›çš„çŠ¶æ€ç ï¼Œå°½å¯èƒ½å¤šçš„è·å–å­åŸŸå

è·å–æ•°æ®ï¼šhostã€titleã€server

CERTè¯ä¹¦å–å­åŸŸåèµ„äº§æ•°æ®ï¼ˆæœ‰äº›ç›´æ¥æ˜¯çœŸå®IPèµ„äº§ï¼ŒFOFAè¯­æ³•ï¼š`cert="baidu.com"`ï¼‰

è·å–æ•°æ®ï¼šhostã€titleã€serverã€ip

2ã€æ›´å¤šå­åŸŸåè·å–æ¸ é“+æœ€ç»ˆç»“æœå»é‡

DNSçˆ†ç ´

ä½¿ç”¨`https://phpinfo.me/domain`çš„top3000å­—å…¸ï¼Œç›´æ¥å¤šçº¿ç¨‹è°ƒç”¨`dns.resolver`è§£æåŸŸåã€‚æµ‹è¯•é€Ÿåº¦æ¯”`ksubdomain`æ— çŠ¶æ€åŸŸåçˆ†ç ´å·¥å…·å¿«ä¸€ç‚¹ï¼ˆåŸå› æ˜¯DBJåªçˆ†ç ´æ²¡åšå…¶å®ƒåŸŸåè·å–æ¸ é“ï¼Œæ¯”å¦‚APIæŸ¥è¯¢æ¥å£è¿™äº›ï¼‰

3ã€CDNè¯†åˆ«

è§£æAè®°å½•æœ‰CNAMEçš„å°±æ˜¯æœ‰CDN

cdn_header[host] - æ”¾åœ¨æŒ‡çº¹è¯†åˆ«é˜¶æ®µ äºŒæ¬¡æ ¡éªŒCDN 

4ã€è°ƒç”¨æŒ‡çº¹è¯†åˆ«æ¨¡å—æ‰«æURLè¯†åˆ«WebæŒ‡çº¹



### IPèµ„äº§ï¼ˆWebèµ„äº§ï¼‰

**è¿™å—ä¸‹ä»»åŠ¡çš„æ ¼å¼æ³¨æ„ä¸‹**

```bash
#å¡«å†™å•ä¸ªIP æˆ– Cæ®µ
111.222.333.444
111.222.333.444/24
```

æ‰«æå•IPæˆ–Cæ®µä¸­Webåº”ç”¨ï¼Œå¹¶è¯†åˆ«WebæŒ‡çº¹

![image-20210311161144314](https://gitee.com/wintrysec/images/raw/master//image-20210311161144314.png)

**å¯¼å‡ºURL**

å¯¼å‡ºå…¨éƒ¨URLï¼Œæˆ–æ ¹æ®æŒ‡çº¹ç´¢å¼•åŒ¹é…èµ„äº§å¯¼å‡ºURLï¼Œç„¶åæ‰”åˆ°åˆ«çš„å·¥å…·æˆ–æ¼æ‰«é‡Œè¾¹è·‘

![image-20210311161942904](https://gitee.com/wintrysec/images/raw/master//image-20210311161942904.png)

### WebæŒ‡çº¹è¯†åˆ«

ä¸‰ç§è¯†åˆ«æ–¹å¼

> 1ï¼‰HTTP-Header åŒ¹é…å…³é”®å­—
>
> 2ï¼‰HTTP-Body åŒ¹é…å…³é”®å­—
>
> 3ï¼‰ICON_HASH åŒ¹é…å…³é”®å­—

WebæŒ‡çº¹è¯†åˆ«æ—¶å¹¶æœªå‘é€æ¶æ„è¯·æ±‚æ‰€ä»¥æ— éœ€ä»£ç†ã€‚

æŒ‡çº¹åº“åœ¨`rules.py`ï¼Œä»¥ä¸€ä¸ª`Dict`çš„å½¢å¼å­˜åœ¨ï¼Œpythonä¸­å­—å…¸çš„ç´¢å¼•æ¯”åˆ—è¡¨(list)å¿«

æ”¶å½•å¸¸è§çš„åº”ç”¨æŒ‡çº¹ï¼Œä¸æ–­æ›´æ–°ä¸­~

æŒ‡çº¹çš„æ¯ä¸ªç‰¹å¾ç”¨ "|" åˆ†å‰²å¼€æ¥ï¼Œå‰åä¸èƒ½æœ‰ç©ºæ ¼

![image-20210311170057173](https://gitee.com/wintrysec/images/raw/master//image-20210311170057173.png)



### ICON_HASHè®¡ç®—

è®¡ç®—å›¾æ ‡çš„å“ˆå¸Œå€¼ï¼Œå¹¶è‡ªåŠ¨åŒ¹é…ç›¸å…³èµ„äº§ï¼ˆé€‚åˆç„å‡†ç›®æ ‡æ—¶ç”¨ï¼‰

![image-20210311164827806](https://gitee.com/wintrysec/images/raw/master//image-20210311164827806.png)

### POCæ’ä»¶æ¼æ‰«

æ¼æ‰«è°ƒç”¨çš„`nuclei`ï¼Œå› ä¸ºè¿™ä¸ªæ¼æ‰«é€Ÿåº¦å¿«æ€§èƒ½å¥½ï¼Œå„ä½å¯è‡ªè¡Œå’Œå¸‚é¢ä¸Šçš„ç›¸å…³å·¥å…·äº§å“å¯¹æ¯”ä¸‹

![](/data/readme/pocscan.png)

POCæŒç»­æ·»åŠ ä¸­.....ï¼ˆæ¼æ‰«æš‚æ—¶åªæ”¯æŒWindowså¹³å°ï¼‰

**æ¼æ‰«è®¾ç½®**

nucleiä¼šåœ¨å½“å‰ç”¨æˆ·ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ª`.config/nuclei`çš„é…ç½®æ–‡ä»¶å¤¹ï¼›

ä¿®æ”¹é‡Œè¾¹ä¸¤ä¸ªé…ç½®æ–‡ä»¶

```bash
#.templates-config.json æ¨¡æ¿é…ç½®æ–‡ä»¶
ä¿®æ”¹templates-directoryçš„ è·¯å¾„ä¸ºå¤§å®å‰‘å½“å‰çš„æ¼æ‰«POCæ¨¡æ¿è·¯å¾„
\DBJ\flaskr\vulnscan\nuclei-templates


#config.yaml æ‰«æå™¨é…ç½®æ–‡ä»¶
update-directory: C:\Users\wintrysec\Desktop\DBJ\flaskr\vulnscan/nuclei-templates
no-color: true
concurrency: 50
rate-limit: 2500
bulk-size: 50
```

## å®‰è£…æ•™ç¨‹

### Docker å®‰è£…æ¨¡å¼

#### æ‰‹åŠ¨ç¼–è¯‘
```bash
git clone https://github.com/wgpsec/DBJ.git # é€Ÿåº¦å¤ªæ…¢å¯ç”¨gitee
cd DBJ
docker build . -t dbj
docker run -d --name dbj -p 0.0.0.0:65000:5000 dbj # æ˜ å°„åˆ°65000ç«¯å£ä¸Š
```
#### ç¬¬ä¸‰æ–¹ç¼–è¯‘âš ï¸
```bash
docker run -it --name dbj -p 5000:5000  xrsec/dbj:latest
```

è®¿é—® http://ip:65000 

#### æŸ¥çœ‹è¾“å‡ºä¿¡æ¯

```bash
docker logs dbj
```

### æ‰‹åŠ¨å®‰è£…


ä¸€ã€å®‰è£…ç¬¬ä¸‰æ–¹åº“

æ¨èä½¿ç”¨`Python3.9`ä»¥ä¸Šç‰ˆæœ¬

```bash
pip install -r requirements.txt
```

äºŒã€å®‰è£…é…ç½®æ•°æ®åº“

> å…ˆå®‰è£…MonGoDBå’ŒRedis

```bash
#é…ç½®MongoDB
mongo
use webapp
db.createCollection("tasks")
db.createCollection("webs")
db.createCollection("subdomains")
db.createCollection("user")
db.user.insert({uid:1,username:'admin',password:'admin'})
exit
```

ä¸‰ã€å¯åŠ¨åº”ç”¨

```bash
#Windowsç³»ç»Ÿ 
ç‚¹å‡»start.bat

#Linuxç³»ç»Ÿ
sh start.sh
```

ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—® IP:5000 ç™»å½•å³å¯ï¼ˆé»˜è®¤è´¦æˆ·å¯†ç admin/adminï¼Œè¿›å»è‡ªå·±æ”¹ï¼‰

